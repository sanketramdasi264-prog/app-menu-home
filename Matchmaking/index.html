<!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡§ó‡•Å‡§£ ‡§Æ‡§ø‡§≤‡§æ‡§®</title>

<style>
body{
  font-family: sans-serif;
  background:#1e1e1e;
  color:white;
  padding:20px;
}
.container{
  max-width:600px;
  margin:auto;
}
select,button{
  width:100%;
  padding:10px;
  margin:8px 0;
  border-radius:6px;
  border:none;
  font-size:16px;
}
button{
  background:#ff5722;
  color:white;
  cursor:pointer;
}
.result{
  margin-top:20px;
  padding:15px;
  background:#2a2a2a;
  border-radius:8px;
}
.score{
  font-size:28px;
  font-weight:bold;
}
.good{color:#4caf50;}
.avg{color:#ff9800;}
.bad{color:#f44336;}
</style>
</head>
<body>

<div class="container">

<h2>üïâÔ∏è ‡§Ö‡§ö‡•Ç‡§ï ‡§ó‡•Å‡§£ ‡§Æ‡§ø‡§≤‡§æ‡§®</h2>

<label>‡§µ‡§∞‡§æ‡§ö‡•Ä ‡§∞‡§æ‡§∂‡•Ä</label>
<select id="boyRashi" onchange="loadNak('boy')">
<option value="">-- ‡§®‡§ø‡§µ‡§°‡§æ --</option>
</select>

<label>‡§µ‡§∞ ‡§®‡§ï‡•ç‡§∑‡§§‡•ç‡§∞</label>
<select id="boyNak">
<option value="">-- ‡§™‡•ç‡§∞‡§•‡§Æ ‡§∞‡§æ‡§∂‡•Ä ‡§®‡§ø‡§µ‡§°‡§æ --</option>
</select>

<hr>

<label>‡§µ‡§ß‡•Ç‡§ö‡•Ä ‡§∞‡§æ‡§∂‡•Ä</label>
<select id="girlRashi" onchange="loadNak('girl')">
<option value="">-- ‡§®‡§ø‡§µ‡§°‡§æ --</option>
</select>

<label>‡§µ‡§ß‡•Ç ‡§®‡§ï‡•ç‡§∑‡§§‡•ç‡§∞</label>
<select id="girlNak">
<option value="">-- ‡§™‡•ç‡§∞‡§•‡§Æ ‡§∞‡§æ‡§∂‡•Ä ‡§®‡§ø‡§µ‡§°‡§æ --</option>
</select>

<button onclick="calculate()">‡§ó‡•Å‡§£ ‡§§‡§™‡§æ‡§∏‡§æ</button>

<div class="result" id="resultBox" style="display:none;">
  <div class="score" id="scoreText"></div>
  <div id="doshaText"></div>
  <div id="levelText"></div>
</div>

</div>

<script>

let gunData = {};

// üî• Load Grouped JSON
fetch("gunmilan_data.json")
.then(res => res.json())
.then(data => {
    gunData = data;
    console.log("Grouped JSON Loaded");
})
.catch(err=>{
    alert("JSON load ‡§ù‡§æ‡§≤‡§æ ‡§®‡§æ‡§π‡•Ä");
});

// üîπ ‡§∞‡§æ‡§∂‡•Ä-‡§®‡§ï‡•ç‡§∑‡§§‡•ç‡§∞ mapping
const rashiMap = {
  "‡§Æ‡•á‡§∑": [["‡§Ö‡§∂‡•ç‡§µ‡§ø‡§®‡•Ä",4],["‡§≠‡§∞‡§£‡•Ä",4],["‡§ï‡•É‡§§‡•ç‡§§‡§ø‡§ï‡§æ",1]],
  "‡§µ‡•É‡§∑‡§≠": [["‡§ï‡•É‡§§‡•ç‡§§‡§ø‡§ï‡§æ",3],["‡§∞‡•ã‡§π‡§ø‡§£‡•Ä",4],["‡§Æ‡•É‡§ó‡§∂‡•Ä‡§∞‡•ç‡§∑",2]],
  "‡§Æ‡§ø‡§•‡•Å‡§®": [["‡§Æ‡•É‡§ó‡§∂‡•Ä‡§∞‡•ç‡§∑",2],["‡§Ü‡§∞‡•ç‡§¶‡•ç‡§∞‡§æ",4],["‡§™‡•Å‡§®‡§∞‡•ç‡§µ‡§∏‡•Ç",3]],
  "‡§ï‡§∞‡•ç‡§ï": [["‡§™‡•Å‡§®‡§∞‡•ç‡§µ‡§∏‡•Ç",1],["‡§™‡•Å‡§∑‡•ç‡§Ø",4],["‡§Ü‡§∂‡•ç‡§≤‡•á‡§∑‡§æ",4]]
};

// üîπ ‡§∞‡§æ‡§∂‡•Ä dropdown load
window.onload = function(){

  const boy = document.getElementById("boyRashi");
  const girl = document.getElementById("girlRashi");

  Object.keys(rashiMap).forEach(r=>{
    boy.innerHTML += `<option value="${r}">${r}</option>`;
    girl.innerHTML += `<option value="${r}">${r}</option>`;
  });
};

// üîπ ‡§®‡§ï‡•ç‡§∑‡§§‡•ç‡§∞ dropdown
function loadNak(type){

  const rashi = document.getElementById(type+"Rashi").value;
  const select = document.getElementById(type+"Nak");

  select.innerHTML = `<option value="">-- ‡§®‡§ø‡§µ‡§°‡§æ --</option>`;

  if(!rashi) return;

  rashiMap[rashi].forEach(n=>{
    const name = n[0];
    const total = n[1];

    for(let i=1;i<=total;i++){
      select.innerHTML += 
        `<option value="${name}-${i}">
           ${name} - ‡§ö‡§∞‡§£ ${i}
         </option>`;
    }
  });
}

////////////////////////////////////////////////////
// üî• MAIN CALCULATION (Grouped JSON Compatible)
////////////////////////////////////////////////////
function calculate(){

  const boyVal = document.getElementById("boyNak").value;
  const girlVal = document.getElementById("girlNak").value;

  if(!boyVal || !girlVal){
    alert("‡§¶‡•ã‡§®‡•ç‡§π‡•Ä ‡§®‡§ï‡•ç‡§∑‡§§‡•ç‡§∞ ‡§®‡§ø‡§µ‡§°‡§æ");
    return;
  }

  const boyNak = boyVal.split("-")[0];
  const girlNak = girlVal.split("-")[0];

  // üîπ Grouped format key
  let key = `${boyNak}-1,2,3,4_${girlNak}-1,2,3,4`;

  if(!gunData[key]){
    key = `${girlNak}-1,2,3,4_${boyNak}-1,2,3,4`;
  }

  const resultBox = document.getElementById("resultBox");
  const scoreText = document.getElementById("scoreText");
  const doshaText = document.getElementById("doshaText");
  const levelText = document.getElementById("levelText");

  if(gunData[key]){

    const score = gunData[key].score;
    const dosha = gunData[key].dosha;

    scoreText.innerText = score + " / 36 ‡§ó‡•Å‡§£";
    doshaText.innerText = "‡§¶‡•ã‡§∑: " + dosha;

    let level = "";
    let className = "";

    if(score >= 28){
      level = "‡§â‡§§‡•ç‡§ï‡•É‡§∑‡•ç‡§ü ‡§ú‡•Å‡§≥‡§£‡•Ä";
      className = "good";
    }
    else if(score >= 18){
      level = "‡§ö‡§æ‡§Ç‡§ó‡§≤‡•Ä ‡§ú‡•Å‡§≥‡§£‡•Ä";
      className = "good";
    }
    else if(score >= 10){
      level = "‡§Æ‡§ß‡•ç‡§Ø‡§Æ ‡§ú‡•Å‡§≥‡§£‡•Ä";
      className = "avg";
    }
    else{
      level = "‡§Ö‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§ú‡•Å‡§≥‡§£‡•Ä";
      className = "bad";
    }

    levelText.innerText = level;
    scoreText.className = "score " + className;

  } else {

    scoreText.innerText = "‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§æ‡§π‡•Ä";
    doshaText.innerText = "";
    levelText.innerText = "";
  }

  resultBox.style.display = "block";
}

</script>

</body>
</html>
